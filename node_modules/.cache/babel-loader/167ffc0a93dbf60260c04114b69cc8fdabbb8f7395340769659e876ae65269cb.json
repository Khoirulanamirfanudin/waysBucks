{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { Button, Card, Container, Form } from \"react-bootstrap\";\nimport Stack from \"react-bootstrap/Stack\";\nimport Vector from \"../img/Vector.png\";\nimport { Popup } from \"../components/PopUp\";\nimport { API } from \"../config/api\";\nimport { useMutation, useQuery } from 'react-query';\nimport NavbarBucks from \"../components/NavbarBucks\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Cart() {\n  _s();\n  const [modalPopShow, setModalPopShow] = useState(false);\n  const [detailUserData, setState] = useState({\n    name: \"\",\n    email: \"\",\n    phone: \"\",\n    posCode: \"\",\n    address: \"\"\n  });\n  let navigate = useNavigate();\n\n  // cart\n  let {\n    data: cart,\n    refetch\n  } = useQuery(\"cartsCache\", async () => {\n    const response = await API.get(\"/carts-id\");\n    return response.data.data;\n  });\n\n  // subtotal\n  let resultTotal = cart === null || cart === void 0 ? void 0 : cart.reduce((a, b) => {\n    return a + b.subtotal;\n  }, 0);\n\n  // remove\n  let handleDelete = async id => {\n    await API.delete(`/cart/` + id);\n    refetch();\n  };\n\n  // pay\n  const form = {\n    status: \"pending\",\n    total: resultTotal\n  };\n  const handleSubmit = useMutation(async e => {\n    const config = {\n      headers: {\n        \"Content-type\": \"application/json\"\n      }\n    };\n\n    // Insert transaction data\n    const body = JSON.stringify(form);\n    const response = await API.patch(\"/transaction\", body, config);\n    const token = response.data.data.token;\n    window.snap.pay(token, {\n      onSuccess: function (result) {\n        console.log(result);\n        navigate(\"/profile\");\n      },\n      onPending: function (result) {\n        console.log(result);\n        navigate(\"/profile\");\n      },\n      onError: function (result) {\n        console.log(result);\n      },\n      onClose: function () {\n        alert(\"you closed the popup without finishing the payment\");\n      }\n    });\n    await API.patch(\"/cart\", body, config);\n  });\n  //\n\n  // useEffect(() => {\n  //   //change this to the script source you want to load, for example this is snap.js sandbox env\n  //   const midtransScriptUrl = \"https://app.sandbox.midtrans.com/snap/snap.js\";\n  //   //change this according to your client-key\n  //   const myMidtransClientKey = process.env.REACT_APP_MIDTRANS_CLIENT_KEY;\n\n  //   let scriptTag = document.createElement(\"script\");\n  //   scriptTag.src = midtransScriptUrl;\n  //   // optional if you want to set script attribute\n  //   // for example snap.js have data-client-key attribute\n  //   scriptTag.setAttribute(\"data-client-key\", myMidtransClientKey);\n\n  //   document.body.appendChild(scriptTag);\n  //   return () => {\n  //     document.body.removeChild(scriptTag);\n  //   };\n  // }, []);\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false);\n}\n_s(Cart, \"yyh5tDlOsohldlczGhZvO9/MZM0=\", false, function () {\n  return [useNavigate, useQuery, useMutation];\n});\n_c = Cart;\nexport default Cart;\nvar _c;\n$RefreshReg$(_c, \"Cart\");","map":{"version":3,"names":["React","useState","Button","Card","Container","Form","Stack","Vector","Popup","API","useMutation","useQuery","NavbarBucks","useNavigate","Cart","modalPopShow","setModalPopShow","detailUserData","setState","name","email","phone","posCode","address","navigate","data","cart","refetch","response","get","resultTotal","reduce","a","b","subtotal","handleDelete","id","delete","form","status","total","handleSubmit","e","config","headers","body","JSON","stringify","patch","token","window","snap","pay","onSuccess","result","console","log","onPending","onError","onClose","alert"],"sources":["/Users/yusufadinata/Documents/WaysBucks/client/src/pages/Cart.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { Button, Card, Container, Form } from \"react-bootstrap\";\nimport Stack from \"react-bootstrap/Stack\";\nimport Vector from \"../img/Vector.png\"\nimport { Popup } from \"../components/PopUp\"\nimport { API } from  \"../config/api\"\nimport { useMutation, useQuery } from 'react-query'\nimport NavbarBucks from \"../components/NavbarBucks\";\nimport { useNavigate } from \"react-router-dom\";\n\nfunction Cart() {\n  const [modalPopShow, setModalPopShow] = useState(false);\n  \n\n  const [detailUserData, setState] = useState({\n    name: \"\",\n    email: \"\",\n    phone: \"\",\n    posCode: \"\",\n    address: \"\",\n  })\n  let navigate = useNavigate();\n\n  // cart\n  let { data: cart, refetch } = useQuery(\"cartsCache\", async () => {\n    const response = await API.get(\"/carts-id\");\n    return response.data.data;\n  });\n\n  // subtotal\n  let resultTotal = cart?.reduce((a, b) => {\n    return a + b.subtotal;\n  }, 0);\n\n  // remove\n  let handleDelete = async (id) => {\n    await API.delete(`/cart/` + id);\n    refetch();\n  };\n\n  // pay\n  const form = {\n    status: \"pending\",\n    total: resultTotal,\n  };\n\n  const handleSubmit = useMutation(async (e) => {\n    const config = {\n      headers: {\n        \"Content-type\": \"application/json\",\n      },\n    };\n\n    // Insert transaction data\n    const body = JSON.stringify(form);\n    const response = await API.patch(\"/transaction\", body, config);\n    const token = response.data.data.token;\n\n    window.snap.pay(token, {\n      onSuccess: function (result) {\n        console.log(result);\n        navigate(\"/profile\");\n      },\n      onPending: function (result) {\n        console.log(result);\n        navigate(\"/profile\");\n      },\n      onError: function (result) {\n        console.log(result);\n      },\n      onClose: function () {\n        alert(\"you closed the popup without finishing the payment\");\n      },\n    });\n\n    await API.patch(\"/cart\", body, config);\n  });\n  //\n\n  // useEffect(() => {\n  //   //change this to the script source you want to load, for example this is snap.js sandbox env\n  //   const midtransScriptUrl = \"https://app.sandbox.midtrans.com/snap/snap.js\";\n  //   //change this according to your client-key\n  //   const myMidtransClientKey = process.env.REACT_APP_MIDTRANS_CLIENT_KEY;\n\n  //   let scriptTag = document.createElement(\"script\");\n  //   scriptTag.src = midtransScriptUrl;\n  //   // optional if you want to set script attribute\n  //   // for example snap.js have data-client-key attribute\n  //   scriptTag.setAttribute(\"data-client-key\", myMidtransClientKey);\n\n  //   document.body.appendChild(scriptTag);\n  //   return () => {\n  //     document.body.removeChild(scriptTag);\n  //   };\n  // }, []);\n\n\n    \n  return (\n    <>\n    \n    </>\n  )\n}\n\nexport default Cart;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}